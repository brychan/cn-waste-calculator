(this.webpackJsonpwaste=this.webpackJsonpwaste||[]).push([[0],{22:function(e,t,n){e.exports=n(45)},27:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(15),l=n.n(i),s=(n(27),n(21)),c=n(13),o=n(3),d=n(4),u=n(10),h=n(7),p=n(6),m=n(53),g=n(52),f=n(51),b=n(47),v=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return r.a.createElement(b.a,null,r.a.createElement("h2",{className:"display-8"},"Total ",this.props.total.toFixed(2)," sek"))}}]),n}(r.a.Component),E=n(48),I=n(49),y=n(54),j=n(50),O=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleChange=a.handleChange.bind(Object(u.a)(a)),a}return Object(d.a)(n,[{key:"handleChange",value:function(e){this.props.handleAmountChange(e.target.value,this.props.ingredient.listId)}},{key:"render",value:function(){var e=this;return r.a.createElement(E.a,null,r.a.createElement(I.a,{type:"text",name:"amount",placeholder:"0",value:this.props.ingredient.amountInput>0?this.props.ingredient.amountInput:"",onChange:this.handleChange}),r.a.createElement(y.a,{addonType:"append"},r.a.createElement(j.a,{color:"danger",tabIndex:"-1",onClick:function(){return e.props.handleDelete(e.props.ingredient.listId)}},"X")))}}]),n}(r.a.Component),C=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"componentWillLeave",value:function(){console.log("AddedIngredient Will Leave")}},{key:"render",value:function(){var e=this;return r.a.createElement(f.a,{key:this.props.ingredient.listId,className:"border-bottom py-1"},r.a.createElement(b.a,{className:"align-self-center"},this.props.ingredient.name,function(){switch(e.props.ingredient.type){case"recipe":return r.a.createElement("span",{className:"badge badge-pill badge-info mx-2"},"Recipe");case"processedIngredient":return r.a.createElement("span",{className:"badge badge-pill badge-success mx-2"},"Processed");default:return r.a.createElement("span",{className:"badge badge-pill badge-warning mx-2"},"Ingredient")}}(),r.a.createElement("br",null),r.a.createElement("small",{className:"text-muted"},"Add amount in ",r.a.createElement("b",null,this.props.ingredient.unit),".")),r.a.createElement(b.a,{xs:"4",className:"align-self-center"},r.a.createElement(O,{ingredient:this.props.ingredient,amountInput:this.props.amountInput,handleAmountChange:this.props.handleAmountChange,handleDelete:this.props.handleDelete})))}}]),n}(r.a.Component),k=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,this.props.list.length>0?this.props.list.map((function(t){return r.a.createElement(C,{key:t.listId,ingredient:t,amountInput:e.props.amountInput,handleDelete:e.props.handleDelete,handleAmountChange:e.props.handleAmountChange})})):r.a.createElement("div",{className:"py-3"},"No items added."))}}]),n}(r.a.Component),w=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleChange=a.handleChange.bind(Object(u.a)(a)),a}return Object(d.a)(n,[{key:"handleChange",value:function(e){this.props.onInputChange(e.target.value)}},{key:"render",value:function(){return r.a.createElement(I.a,{type:"text",placeholder:"Type an ingredient...",name:"ingredient",innerRef:this.props.inputRef,className:"my-1 mx-0 px-3 text-white border-0 bg-secondary",value:this.props.currentValue,onChange:this.handleChange})}}]),n}(r.a.Component),x=n(16),A=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleAdd=a.handleAdd.bind(Object(u.a)(a)),a}return Object(d.a)(n,[{key:"handleAdd",value:function(){this.props.handleAdd(this.props.ingredient),this.props.searchInputRef.focus()}},{key:"render",value:function(){var e=this;return r.a.createElement(f.a,{className:"border-top border-secondary py-1"},r.a.createElement(b.a,{className:"align-self-center"},r.a.createElement("span",null,this.props.ingredient.name),function(){switch(e.props.ingredient.type){case"recipe":return r.a.createElement("span",{className:"badge badge-pill badge-info mx-2"},"Recipe");case"processedIngredient":return r.a.createElement("span",{className:"badge badge-pill badge-success mx-2"},"Processed");default:return r.a.createElement("span",{className:"badge badge-pill badge-warning mx-2"},"Ingredient")}}()),r.a.createElement(b.a,{xs:"3",className:"float-right"},r.a.createElement(j.a,{className:"float-right",color:"info",onClick:this.handleAdd},"Add")))}}]),n}(r.a.Component),N=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(g.a,{fluid:!0,className:"px-0"},this.props.list.map((function(t){return r.a.createElement(A,{key:t.searchableId,ingredient:t,handleAdd:e.props.handleAdd,searchInputRef:e.props.searchInputRef})})))}}]),n}(r.a.Component);var R=function(e){return r.a.createElement(x.Spring,{native:!0,force:!0,config:{tension:2e3,friction:100,precision:1},to:{height:e.toggle?"auto":0,display:e.toggle?"block":"none"}},(function(t){return r.a.createElement(x.animated.div,{className:"item",style:t},r.a.createElement(N,{list:e.list,handleAdd:e.handleAdd,searchInputRef:e.searchInputRef}))}))},S=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).onToggle=function(){a.setState((function(e){return{toggle:!e.toggle}}))},a.state={ingredientInput:"",results:[],toggle:!0},a.handleChange=a.handleChange.bind(Object(u.a)(a)),a.handleClose=a.handleClose.bind(Object(u.a)(a)),a}return Object(d.a)(n,[{key:"getResults",value:function(e){var t=e.toLowerCase();return this.props.list.filter((function(e){return e.name.toLowerCase().includes(t)}))}},{key:"handleChange",value:function(e){if(this.setState({ingredientInput:e}),0==e.length&&this.setState({results:[],toggle:!0}),e.length>=3){var t=this.getResults(e);this.setState({results:t,toggle:!0})}}},{key:"handleClose",value:function(){this.setState({ingredientInput:"",results:[]})}},{key:"renderCollapseButton",value:function(e){var t=null;return e>0&&(t=r.a.createElement("div",{className:"float-middle m-1 p-0 text-light",role:"button",onClick:this.onToggle},r.a.createElement("svg",{version:"1.1",id:"Capa_1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"-20px",width:"3rem",height:"1.5rem",viewBox:"0 0 451.847 451.847"},r.a.createElement("g",null,r.a.createElement("path",{transform:"translate(0, 100)",fill:"white",d:this.state.toggle?"M248.292,106.406l194.281,194.29c12.365,12.359,12.365,32.391,0,44.744c-12.354,12.354-32.391,12.354-44.744,0 L225.923,173.529L54.018,345.44c-12.36,12.354-32.395,12.354-44.748,0c-12.359-12.354-12.359-32.391,0-44.75L203.554,106.4 c6.18-6.174,14.271-9.259,22.369-9.259C234.018,97.141,242.115,100.232,248.292,106.406z":"M225.923,354.706c-8.098,0-16.195-3.092-22.369-9.263L9.27,151.157c-12.359-12.359-12.359-32.397,0-44.751 c12.354-12.354,32.388-12.354,44.748,0l171.905,171.915l171.906-171.909c12.359-12.354,32.391-12.354,44.744,0 c12.365,12.354,12.365,32.392,0,44.751L248.292,345.449C242.115,351.621,234.018,354.706,225.923,354.706z"}))))),t}},{key:"render",value:function(){var e=this;return r.a.createElement(b.a,null,r.a.createElement(b.a,{className:"w-100 bg-dark"},r.a.createElement(w,{currentValue:this.state.ingredientInput,onInputChange:this.handleChange,inputRef:function(t){return e.searchInputRef=t}})),r.a.createElement("div",{className:"w-100"}),r.a.createElement(b.a,{className:"text-left bg-dark left-0 zindex-dropdown pb-2"},r.a.createElement(R,{list:this.state.results,toggle:this.state.toggle,handleAdd:this.props.handleAdd,searchInputRef:this.searchInputRef}),r.a.createElement("div",{className:"d-flex justify-content-center"},this.renderCollapseButton(this.state.results.length))),r.a.createElement("div",{className:"w-100"}))}}]),n}(r.a.Component),L=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={allIngredients:[],addedIngredients:[],total:0,isLoading:!0},a.handleAdd=a.handleAdd.bind(Object(u.a)(a)),a.handleAmountChange=a.handleAmountChange.bind(Object(u.a)(a)),a.handleDelete=a.handleDelete.bind(Object(u.a)(a)),a}return Object(d.a)(n,[{key:"callAPI",value:function(){var e=this;fetch("https://ingredientsbook-api.herokuapp.com/book").then((function(e){return e.text()})).then((function(t){e.setState({allIngredients:e.createSearchableTable(JSON.parse(t))})}))}},{key:"createSearchableTable",value:function(e){var t=[];return e.ingredients.forEach((function(e){var n={id:e.id,searchableId:Object(m.a)(),name:e.name,avgPrice:e.average_price_unit,unit:e.unit,weightPerUnit:e.weight_per_unit,type:"ingredient"};t.push(n)})),e.processedIngredients.forEach((function(e){var n=t.find((function(t){return t.id===e.ingredient&&"ingredient"===t.type})),a={id:e.id,searchableId:Object(m.a)(),name:e.name,avgPrice:n.avgPrice/e.yield,unit:n.unit,type:"processedIngredient"};t.push(a)})),e.recipes.forEach((function(n){var a=0,r=0;e.recipesIngredients.forEach((function(e){if(n.id===e.recipe){var i=null;i="i"===e.type?t.find((function(t){return t.id===e.id_item&&"ingredient"===t.type})):t.find((function(t){return t.id===e.id_item&&"processedIngredient"===t.type})),r=i?i.avgPrice*e.amount+r:r,a+=e.amount*i.weightPerUnit}}));var i={id:n.id,searchableId:Object(m.a)(),name:n.name,avgPrice:r/a,unit:n.output_weight_unit,batchWeight:a,type:"recipe"};t.push(i)})),this.setState({isLoading:!1}),t}},{key:"componentDidMount",value:function(){this.callAPI()}},{key:"handleAdd",value:function(e){var t=Object(c.a)(Object(c.a)({},e),{},{amountInput:0,listId:Object(m.a)()});this.setState({addedIngredients:[].concat(Object(s.a)(this.state.addedIngredients),[t])})}},{key:"calculateTotal",value:function(e){return e.reduce((function(e,t){return parseFloat(e)+parseFloat(t.avgPrice)*parseFloat(t.amountInput?t.amountInput:0)}),0)}},{key:"handleDelete",value:function(e){var t=this.state.addedIngredients.filter((function(t){return t.listId!==e})),n=this.calculateTotal(t);this.setState({addedIngredients:t,total:n})}},{key:"handleAmountChange",value:function(e,t){var n=0,a=this.state.addedIngredients.map((function(a){if(a.listId===t){var r=Object(c.a)(Object(c.a)({},a),{},{amountInput:e});return n+=e*a.avgPrice,r}return n+=a.amountInput*a.avgPrice,a}));this.setState({addedIngredients:a,total:n})}},{key:"render",value:function(){return r.a.createElement(g.a,{className:"themed-container container-width"},r.a.createElement(f.a,{className:"text-white bg-dark text-center pt-1"},r.a.createElement(v,{total:this.state.total})),r.a.createElement(f.a,{className:"text-white bg-dark text-center"},r.a.createElement(S,{list:this.state.allIngredients,handleAdd:this.handleAdd})),r.a.createElement(f.a,null,r.a.createElement(b.a,null,this.state.isLoading?"Loading data, it might take a minute...":"",r.a.createElement(k,{list:this.state.addedIngredients,amountInput:0,handleDelete:this.handleDelete,handleAmountChange:this.handleAmountChange}))),r.a.createElement(f.a,null,r.a.createElement(b.a,{className:"small"},"Last updated: 12/2020.")))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(L,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[22,1,2]]]);
//# sourceMappingURL=main.70ad93f5.chunk.js.map